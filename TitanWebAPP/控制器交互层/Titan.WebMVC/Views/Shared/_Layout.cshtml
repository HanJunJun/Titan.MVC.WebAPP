@using Titan.Controllers.ViewModel
@using Titan.Model.DataModel
@{
    var sysTitleList = (List<SysTitleViewList>)ViewBag.LeftTitleModel;
    var sysCompanyList = (List<SysCompany>)ViewBag.CompanyModel;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>@ViewData["CommonDataSysTitle"]</title>
    <!-- Favicon-->
    <link rel="icon" href="@ViewData["CommonDataCompanyLogoImgUrl"]" type="image/x-icon">
    <link href="~/css/google_fonts/googleFonts.css" rel="stylesheet" type="text/css">
    <link href="~/css/google_fonts/googleIcon.css" rel="stylesheet" type="text/css">
    @Styles.Render("~/commoncss")
    @Scripts.Render("~/Script/jqUI")
    <!-- Bootstrap Select Css -->
    @*<link href="../../plugins/bootstrap-select/css/bootstrap-select.css" rel="stylesheet" />*@
    @*<link href="~/plugins/multi-select/css/multi-select.css" rel="stylesheet">*@
    <!-- Multi Select Plugin Js -->
    @*<script src="~/plugins/multi-select/js/jquery.multi-select.js"></script>*@
</head>
<body class="theme-red">
    <!-- #START# 页面加载等待 -->
    <div class="page-loader-wrapper">
        <div class="loader">
            <div class="preloader">
                <div class="spinner-layer pl-red">
                    <div class="circle-clipper left">
                        <div class="circle"></div>
                    </div>
                    <div class="circle-clipper right">
                        <div class="circle"></div>
                    </div>
                </div>
            </div>
            <p>正在加载...</p>
        </div>
    </div>
    <!-- #END# 页面加载等待 -->
    <!-- #START# 侧边栏覆盖 -->
    <div class="overlay"></div>
    <!-- #END# 侧边栏覆盖 -->
    <!-- #START# 顶部查询 -->
    <div class="search-bar">
        <div class="search-icon">
            <i class="material-icons">search</i>
        </div>
        <input type="text" placeholder="查询...">
        <div class="close-search">
            <i class="material-icons">close</i>
        </div>
    </div>
    <!-- #END# 顶部查询 -->
    <!-- #START# 顶部菜单 -->
    <nav class="navbar">
        <div class="container-fluid">
            <div class="navbar-header">
                <a href="javascript:void(0);" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"></a>
                <a href="javascript:void(0);" class="bars"></a>
                <a class="navbar-brand" href="/Login/IndexView" id="TopSysTitle">@ViewData["CommonDataSysTitle"]</a>
            </div>
            <div class="collapse navbar-collapse" id="navbar-collapse">

                <!-- #START# 右上角按钮展示 -->
                <ul class="nav navbar-nav navbar-right">
                    <li style="width: 200px;margin-top: 19px">
                        <select class="form-control show-tick" data-live-search="true" onchange="ChangeSysCompany(this)">
                            @{
                                foreach (var item in sysCompanyList)
                                {

                                    if (item.SysCompanyId.ToString() == ViewData["CommonDataCID"].ToString())
                                    {
                                        <option selected="selected" value="@item.SysCompanyId">@(item.CompanyDesc + item.SysCompanyName)</option>
                                    }
                                    else
                                    {
                                        <option value="@item.SysCompanyId">@(item.CompanyDesc + item.SysCompanyName)</option>
                                    }
                                }
                            }
                        </select>
                    </li>
                    <!-- #START# 查询 -->
                    <li><a href="javascript:void(0);" class="js-search" data-close="true"><i class="material-icons">search</i></a></li>
                    <!-- #END# 查询 -->
                    <!-- #START# 提醒 -->
                    <li class="dropdown">
                        <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button">
                            <i class="material-icons">notifications</i>
                            <span class="label-count">7</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="header">消息</li>
                            <li class="body">
                                <ul class="menu">
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-light-green">
                                                <i class="material-icons">person_add</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4>12 new members joined</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> 14 mins ago
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-cyan">
                                                <i class="material-icons">add_shopping_cart</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4>4 sales made</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> 22 mins ago
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-red">
                                                <i class="material-icons">delete_forever</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4><b>Nancy Doe</b> deleted account</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> 3 hours ago
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-orange">
                                                <i class="material-icons">mode_edit</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4><b>Nancy</b> changed name</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> 2 hours ago
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-blue-grey">
                                                <i class="material-icons">comment</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4><b>John</b> commented your post</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> 4 hours ago
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-light-green">
                                                <i class="material-icons">cached</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4><b>John</b> updated status</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> 3 hours ago
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <div class="icon-circle bg-purple">
                                                <i class="material-icons">settings</i>
                                            </div>
                                            <div class="menu-info">
                                                <h4>Settings updated</h4>
                                                <p>
                                                    <i class="material-icons">access_time</i> Yesterday
                                                </p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="footer">
                                <a href="javascript:void(0);">查看所有消息</a>
                            </li>
                        </ul>
                    </li>
                    <!-- #END# 提醒 -->
                    <!-- #START# 任务进度展示 -->
                    <li class="dropdown">
                        <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button">
                            <i class="material-icons">flag</i>
                            <span class="label-count">9</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="header">任务</li>
                            <li class="body">
                                <ul class="menu tasks">
                                    <li>
                                        <a href="javascript:void(0);">
                                            <h4>
                                                Footer display issue
                                                <small>32%</small>
                                            </h4>
                                            <div class="progress">
                                                <div class="progress-bar bg-pink" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100" style="width: 32%">
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <h4>
                                                Make new buttons
                                                <small>45%</small>
                                            </h4>
                                            <div class="progress">
                                                <div class="progress-bar bg-cyan" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <h4>
                                                Create new dashboard
                                                <small>54%</small>
                                            </h4>
                                            <div class="progress">
                                                <div class="progress-bar bg-teal" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100" style="width: 54%">
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <h4>
                                                Solve transition issue
                                                <small>65%</small>
                                            </h4>
                                            <div class="progress">
                                                <div class="progress-bar bg-orange" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100" style="width: 65%">
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <h4>
                                                Answer GitHub questions
                                                <small>92%</small>
                                            </h4>
                                            <div class="progress">
                                                <div class="progress-bar bg-purple" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100" style="width: 92%">
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="footer">
                                <a href="javascript:void(0);">查看所有任务</a>
                            </li>
                        </ul>
                    </li>
                    <!-- #END# 任务进度展示 -->
                    <li class="pull-right"><a href="javascript:void(0);" class="js-right-sidebar" data-close="true"><i class="material-icons">more_vert</i></a></li>
                </ul>
                <!-- #END# 右上角提醒按钮 -->
            </div>
        </div>
    </nav>
    <!-- #END# 顶部菜单 -->
    <!-- #START# 左侧(左侧模块树，右侧隐藏设置皮肤页) -->
    @Html.Partial("_LeftTitlePartial", sysTitleList)
    <!-- #END# 左侧 -->
    <!-- #START# 右侧数据主体 -->
    <section class="content">
        <div class="container-fluid" id="NewDataView">
            @RenderBody()
        </div>
    </section>
    <!-- #END# 右侧数据主体 -->

</body>
</html>
@Scripts.Render("~/Script/CoreJs")
<script type="text/javascript">
    //退出到登录页
    function SignOut() {
        window.location.href = '/Login/LoginView';
        window.location.reload;
    }

    //其他下拉列表
    $(".dropdown-menu a").click(function () {
        if (typeof ($(this).attr("data-id")) != "undefined") {
            //等待提示
            var loadHtml = "<div class='loadingCentercss'\">" +
                "<img src=\"/images/Common/loading11.gif\">" +
                "</div>";
            $("#NewDataView").empty();
            $("#NewDataView").html(loadHtml);

            //获取页面html
            var url = $(this).attr("data-id");
            $.ajax({
                type: "GET",
                url: url,
                success: function (mess) {
                    $("#NewDataView").empty();
                    $("#NewDataView").html(mess);
                },
                error: function (error) {

                }
            });
        }
    });

    //左侧模块列表动态打开页面
    $("#leftsidebar .menu a").click(function () {
        if (typeof ($(this).attr("data-id")) != "undefined") {
            //等待提示
            var loadHtml = "<div class='loadingCentercss'\">" +
                "<img src=\"/images/Common/loading11.gif\">" +
                "</div>";
            $("#NewDataView").empty();
            $("#NewDataView").html(loadHtml);

            //获取页面html
            var url = $(this).attr("data-id");
            $.ajax({
                type: "GET",
                url: url,
                success: function (mess) {
                    $("#NewDataView").empty();
                    $("#NewDataView").html(mess);
                },
                error: function (error) {

                }
            });

            //去掉上一个选中状态
            $("#leftsidebar .menu .active").each(function () {
                $(this).find(".toggled").removeClass("toggled");//去掉子选项的选中效果
                $(this).removeClass("active");//去掉父选中效果
            });
            //加选中效果
            $(this).addClass("toggled");
            $(this).parent().addClass("active");//子节点
            $(this).parent().parent().parent().addClass("active");//父节点
            $(this).parent().parent().parent().find("a").addClass("toggled");
        }
    });

    //工作台click
    function HomeClick(me) {

        //等待提示
        var loadHtml = "<div class='loadingCentercss'\">" +
            "<img src=\"/images/Common/loading11.gif\">" +
            "</div>";
        $("#NewDataView").empty();
        $("#NewDataView").html(loadHtml);

        //填充首页视图
        $.ajax({
            type: "GET",
            url: "/Home/HomePageView",
            success: function (mess) {
                $("#NewDataView").empty();
                $("#NewDataView").html(mess);
            },
            error: function (error) {

            }
        });

        //把所有打开的都关掉
        $("#leftsidebar .menu .active").each(function () {
            $(this).find(".toggled").removeClass("toggled");//去掉子选项的选中效果
            $(this).removeClass("active");//去掉父选中效果
            $(this).find(".ml-menu").css("display", "none");
        });

        //把所有list展开的也折叠起来
        $("#leftsidebar .menu .toggled").each(function () {
            $(this).removeClass("toggled");
            $(this).parent().find("ul").css("display", "none");
        });

        //把自己高亮显示
        $(me).parent().addClass("active");
        $(me).addClass("toggled");
    }

    //切换机构
    function ChangeSysCompany(obj) {
        var value = obj.options[obj.selectedIndex].value;//切换的机构id
        $.ajax({
            type: "GET",
            url: "/Login/ChangeSysCompany",
            data: { sysCompanyId: value },
            success: function (data) {
                var sysTitle = data.CompanyTitle;
                document.title = sysTitle;
                $("#TopSysTitle").html(sysTitle);
                $("#BottomSysTitle").html(sysTitle);
                //切换机构名字
                var companyName = data.SysCompanyName;
                //切换机构顶部背景图片
                var companyTopImgUrl = data.CompanyTopImgUrl;
                //切换机构顶部机构Logo图标
                var companyLogoImgUrl = data.CompanyLogoImgUrl;
                //刷新工作台
                $("#NewDataView").empty();
                $("#HomePageObj").click();
            },
            error: function (error) {

            }
        });
    }
</script>